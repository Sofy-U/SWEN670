CREATE TABLE ALLERGY(
    ALLERGY_ID BIGINT NOT NULL,
    ALLERGY_NAME VARCHAR(50)
);
ALTER TABLE ALLERGY ADD CONSTRAINT PRIMARY KEY(ALLERGY_ID);
CREATE TABLE MED_CONDITION(
    CONDITION_ID BIGINT NOT NULL,
    CONDITION_NAME VARCHAR(50)
);
ALTER TABLE MED_CONDITION ADD CONSTRAINT PRIMARY KEY(CONDITION_ID);
CREATE TABLE MEDICATION(
    MEDICATION_ID BIGINT NOT NULL,
    BLOOD_THINNER BOOLEAN,
    BRAND_NAME VARCHAR(50),
    CONTROLLED BOOLEAN,
    DRUG_ACTION VARCHAR(50),
    GENERIC_NAME VARCHAR(50)
);
ALTER TABLE MEDICATION ADD CONSTRAINT PRIMARY KEY(MEDICATION_ID);
CREATE TABLE USER_ALLERGY(
    USER_ID BIGINT NOT NULL,
    ALLERGY_ID BIGINT NOT NULL
);
ALTER TABLE USER_ALLERGY ADD CONSTRAINT PRIMARY KEY(USER_ID, ALLERGY_ID);
CREATE TABLE USER_CONDITION(
    USER_ID BIGINT NOT NULL,
    CONDITION_ID BIGINT NOT NULL
);
ALTER TABLE USER_CONDITION ADD CONSTRAINT PRIMARY KEY(USER_ID, CONDITION_ID);
CREATE TABLE USER_MED_LIST(
    MEDICATION_ID BIGINT NOT NULL,
    USER_ID BIGINT NOT NULL,
    DOSAGE FLOAT NOT NULL,
    FREQ_INTERVAL VARCHAR(10),
    FREQUENCY INTEGER NOT NULL
);
ALTER TABLE USER_MED_LIST ADD CONSTRAINT PRIMARY KEY(MEDICATION_ID, USER_ID);
CREATE TABLE USER_MEDICATION(
    USER_ID BIGINT NOT NULL,
    MEDICATION_ID BIGINT NOT NULL
);
ALTER TABLE USER_MEDICATION ADD CONSTRAINT PRIMARY KEY(USER_ID, MEDICATION_ID);
CREATE TABLE VLOL_ROLE(
    ROLE_ID BIGINT NOT NULL,
    ACCESS_LEVEL INTEGER NOT NULL CHECK (ACCESS_LEVEL <= 20),
    DESCRIPTION VARCHAR(300),
    TITLE VARCHAR(50) NOT NULL
);
ALTER TABLE VLOL_ROLE ADD CONSTRAINT PRIMARY KEY(ROLE_ID);
CREATE TABLE VLOL_USER(
    USER_ID BIGINT NOT NULL,
    DOB DATE NOT NULL,
    SSN VARCHAR(9) NOT NULL,
    ADMIN_COMMENTS VARCHAR(300),
    ADV_DIR_TYPE VARCHAR(50),
    ADV_DIRECTIVE BOOLEAN,
    CITY VARCHAR(50) NOT NULL,
    DATE_CREATED TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    DOCTOR_NAME VARCHAR(100),
    DOCTOR_PHONE VARCHAR(10),
    EMAIL VARCHAR(320) NOT NULL,
    FIRST_NAME VARCHAR(50) NOT NULL,
    INS_COMPANY VARCHAR(50),
    INS_POLICY_NO VARCHAR(50),
    IS_ACTIVE BOOLEAN,
    IS_LOCKED BOOLEAN,
    LAST_LOGIN_DATE TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    LAST_NAME VARCHAR(100) NOT NULL,
    PASSWORD VARCHAR(72) NOT NULL,
    PHONE VARCHAR(10) NOT NULL,
    POC_NAME VARCHAR(100) NOT NULL,
    POC_PHONE VARCHAR(10) NOT NULL,
    SECURITY_ANSWER VARCHAR(72) NOT NULL,
    SECURITY_QUESTION VARCHAR(100) NOT NULL,
    US_STATE VARCHAR(2) NOT NULL,
    STREET_ADDRESS VARCHAR(100) NOT NULL,
    USER_COMMENTS VARCHAR(300),
    USERNAME VARCHAR(320) NOT NULL,
    ZIP_CODE VARCHAR(5) NOT NULL,
    ROLE_ID BIGINT NOT NULL
);
ALTER TABLE VLOL_USER ADD CONSTRAINT PRIMARY KEY(USER_ID);
ALTER TABLE ALLERGY ADD CONSTRAINT UNIQUE(ALLERGY_NAME);
ALTER TABLE VLOL_USER ADD CONSTRAINT UNIQUE(EMAIL);
ALTER TABLE MEDICATION ADD CONSTRAINT UNIQUE(BRAND_NAME);
ALTER TABLE VLOL_USER ADD CONSTRAINT UNIQUE(USERNAME);
ALTER TABLE VLOL_USER ADD CONSTRAINT UNIQUE(SSN);
ALTER TABLE MED_CONDITION ADD CONSTRAINT UNIQUE(CONDITION_NAME);
ALTER TABLE VLOL_ROLE ADD CONSTRAINT UNIQUE(TITLE);
ALTER TABLE USER_MED_LIST ADD CONSTRAINT FOREIGN KEY(MEDICATION_ID) REFERENCES MEDICATION(MEDICATION_ID);
ALTER TABLE USER_MED_LIST ADD CONSTRAINT FOREIGN KEY(USER_ID) REFERENCES VLOL_USER(USER_ID);
ALTER TABLE USER_MEDICATION ADD CONSTRAINT FOREIGN KEY(USER_ID) REFERENCES VLOL_USER(USER_ID);
ALTER TABLE USER_CONDITION ADD CONSTRAINT FOREIGN KEY(USER_ID) REFERENCES VLOL_USER(USER_ID);
ALTER TABLE USER_ALLERGY ADD CONSTRAINT FOREIGN KEY(ALLERGY_ID) REFERENCES ALLERGY(ALLERGY_ID);
ALTER TABLE USER_ALLERGY ADD CONSTRAINT FOREIGN KEY(USER_ID) REFERENCES VLOL_USER(USER_ID);
ALTER TABLE USER_MEDICATION ADD CONSTRAINT FOREIGN KEY(MEDICATION_ID) REFERENCES MEDICATION(MEDICATION_ID);
ALTER TABLE USER_CONDITION ADD CONSTRAINT FOREIGN KEY(CONDITION_ID) REFERENCES MED_CONDITION(CONDITION_ID);
ALTER TABLE VLOL_USER ADD CONSTRAINT FOREIGN KEY(ROLE_ID) REFERENCES VLOL_ROLE(ROLE_ID);